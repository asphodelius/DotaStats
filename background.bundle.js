(()=>{"use strict";chrome.runtime.onMessage.addListener((function(n,a,e){var t,o;"fetchDotaStats"===n.action&&(t=Number(n.steamID),o={steamAccountId:t},fetch("https://api.stratz.com/graphql",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat("eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJTdWJqZWN0IjoiYTA2OTVhZGUtMDE0YS00YmExLTgzYWItNzc3MzkxZWJmOTY3IiwiU3RlYW1JZCI6Ijg4ODM0NDQ2MCIsIm5iZiI6MTY5NzQ4NzUzNCwiZXhwIjoxNzI5MDIzNTM0LCJpYXQiOjE2OTc0ODc1MzQsImlzcyI6Imh0dHBzOi8vYXBpLnN0cmF0ei5jb20ifQ.RlhYbdW9Sv1rLO2KBEhdyac4yB9iSSeyRmUbYXeWkcU")},body:JSON.stringify({query:"\n    query MyQuery($steamAccountId: Long!) {\n      player(steamAccountId: $steamAccountId) {\n        steamAccount {\n          name \n          avatar \n          isAnonymous \n          seasonRank \n          smurfFlag\n          seasonLeaderboardRank\n        }\n        firstMatchDate\n        matchCount \n        winCount \n      }\n    }\n  ",variables:o})}).then((function(n){return n.json()})).then((function(n){return function(n){var a=function(n){var a,e,t,o,s,r,i,c,u=null==n||null===(a=n.data)||void 0===a?void 0:a.player,l={playerName:(null==u||null===(e=u.steamAccount)||void 0===e?void 0:e.name)||"",isAnonymous:(null==u||null===(t=u.steamAccount)||void 0===t?void 0:t.isAnonymous)||!1,seasonRank:(null==u||null===(o=u.steamAccount)||void 0===o?void 0:o.seasonRank)||"",smurfFlag:(null==u||null===(s=u.steamAccount)||void 0===s?void 0:s.smurfFlag)||!1,seasonLeaderboardRank:(null==u||null===(r=u.steamAccount)||void 0===r?void 0:r.seasonLeaderboardRank)||"",matchCount:(null==u?void 0:u.matchCount)||0,winCount:(null==u?void 0:u.winCount)||0,firstMatchDate:(i=null==u?void 0:u.firstMatchDate,i?new Date(1e3*i):null)};return l.medalImage=80===(c=l.seasonRank)?"":"images/ranks/medal_".concat(Math.floor(c/10),".png"),l.starImage=function(n){var a=parseInt(n);return a&&a<80&&a%10!=0?"images/ranks/star_".concat(a%10,".png"):""}(l.seasonRank),l.leaderboardMedalImage=function(n,a){var e=parseInt(n),t=parseInt(a);return 80!==e||isNaN(t)?"":t<=10?"images/ranks/medal_8c.png":t<=100?"images/ranks/medal_8b.png":"images/ranks/medal_8.png"}(l.seasonRank,l.seasonLeaderboardRank),l}(n);!function(n){chrome.tabs.query({active:!0,currentWindow:!0},(function(a){var e=a[0];e?chrome.tabs.sendMessage(e.id,{action:"updateDotaStats",data:n}):console.error("No active tab found")}))}(a)}(n)})).catch((function(n){return console.error("GraphQL Error:",n)})))}))})();